---
title: "R for Data Science - Solutions Manual"
author: ["Jonathan Mendes de Almeida", "jonathanalmd@gmail.com", "jonathan@aluno.unb.br","@jonyddev (github)"]
lang: en
date: "`r format(Sys.time(), '%b %d, %Y')`"
output:
    pdf_document:
      latex_engine: xelatex
---

Solutions to the exercises in [**R for Data Science (Garrett Grolemund & Hadley Wickham)**](http://r4ds.had.co.nz/index.html). The individual R files are available in my github - [**@jonyddev**](https://github.com/jonyddev) - repository called [**R4DataScience-Solutions**](https://github.com/jonyddev/R4DataScience-Solutions). _If you have any questions about my answers to these exercises do not hesitate to enter in contact with me_.

## Prerequisites
```{r eval = TRUE}
library(tidyverse)
```

### To install tidyverse library:
```{r eval = FALSE}
install.packages('tidyverse')
```

## mpg data frame
```{r eval = TRUE}
mpg = ggplot2::mpg
mpg
```

# Chapter 1
No exercises in this chapter.

# Chapter 2
No exercises in this chapter.

# Chapter 3

## 3.2.4 Exercises

### Exercise 1
>  Run `ggplot(data = mpg)`. What do you see?

```{r eval = TRUE}
ggplot(data = mpg)
```

**(Answer)** An empty plot. To see some nice plots we should add some geom_function to map some points. Add a good caption for each axis is great to make your plot easier to read and understand!

### Exercise 2
> How many rows are in `mpg`? How many columns?

```{r eval = TRUE}
nrow(mpg)
ncol(mpg)
```

**(Answer)** 234 rows and 11 columns


Alternative method to check the number of rows and columns of a data frame:

```{r eval = TRUE}
glimpse(mpg)
```

### Exercise 3
> What does the `drv` variable describe? Read the help for ?mpg to find out.
_run ?mpg in RStudio console and check the 'help' tab)_

```{r eval = TRUE}
mpg['drv']
```

**(Answer)** The **drv** variable describes the traction control system. There are 3 possible values for `drv` variable (**variable** : _description_):
 
* **f**: _front-wheel drive_

* **r**: _rear wheel drive_

* **4**: _4wd_

### Exercise 4
> Make a scatterplot of `hwy` vs `cyl`

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = hwy, y = cyl, colour = class))
```

**(Answer)** We add a definition of the data used in x,y axis and add geom_point function mapping these points. Here we are using aes(colour = class) (to associate the name of the aesthetic with a variable to display) to plot using a different colour for each class present in our data frame (car type: 2seater, compact, midsize, minivan, pickup, subcompact, suv).

### Exercise 5
> What happens if you make a scatterplot of *class* __vs__ *drv*? Why is the plot not useful?

```{r eval = TRUE}
ggplot(data = mpg, aes(x = class, y = drv)) + geom_point()
```

**(Answer)** This plot is not useful because `class` and `drv` are factor variables. Each possible value of these two variables is limited by a set (r, f and 4 are the possible values for `drv`  and 2seater, compact, midsize, minivan, pickup, subcompact and suv are the possible values for `class`). This plot is pretty useless to perform a data analysis.

## 3.3.1 Exercises

### Exercise 1
> What's gone wrong with this code? Why are the points not blue?

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = "blue"))
```

**(Answer)** The `color` argument is not in the correct place. The `color` argument is included inside the `mapping` argument so it is treated as an aesthetic, which receives a variable (like we used `class` as argument in previous exercise). In this case, the `color` argument is interpreted as a variable with only one value (which is "blue" in this case).

If the goal is to plot all these points using blue, the correct code is:

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy), color = "blue")
```


### Exercise 2
> Which variables in `mpg` are categorical? Which variables are continuous? (**Hint:** _type **?mpg** (using RStudio console) to read the documentation for the dataset_). How can you see this information when you run `mpg`?

If you are not able to classify each variable as categorical or continuous by checking the description of each variable (by typing `?mpg`) you can print the data frame and R will answer this for you (another way to check this information is using the glimpse() function). 

```{r eval = TRUE}
mpg
```

As you can see, the information is given at top of each column within '<>'. If the variable is categorical, it will have a class of 'character' (represented as `<chr>`). So, once you know where to find this is information is easy to anwser which variable is categorical and which is continuous.  

* **model**: categorical

* **displ**: continuous

* **year**: continuous

* **cyl**: continuous

* **trans**: categorical

* **drv**: categorical

* **cty**: continuous

* **hwy**: continuous

* **fl**: categorical

* **class**: categorical

### Exercise 3
> Map a continuous variable to `color`, `size` and `shape`. How do these aesthetics behave differently for **categorical** _vs_ **continuous** variables?

_Using the varible **cty** (city miles per gallon) - which is a continuous variable._

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, colour = cty))
```

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, size = cty))
```

**(Answer)** When mapped to colour: the continuous variable uses a scale that varies using tons of blue (light to dark). 

When mapped to size: the continuous variable uses a scale that varies using different sizes.

These information is easy to verify by checking these two previous plots. 

However, when mapped to shape, R will give an error (a continuous variable can not be mapped to shape). This is because shapes does not have a natural order.

###  Exercise 4
> What happens if you map the same variable to multiple aesthetics?

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, colour = displ, size = hwy))
```

Mapping one variable to multiple aesthetics is not a good idea because is redundant. Using different variables and the plot will show more information about your dataset. The next plot uses four different variables in aesthetics, which gives useful aditional information when compared to all the previous plots.

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, colour = cty, size = cyl))
```

### Exercise 5
> What does the `stroke` aesthetic do? What shapes does it work with? (Hint: use `?geom_point` and check the 'help' tab)

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, shape = drv), stroke = 5)
```

**(Answer)** The `stroke` aesthetic is used to modify the width of the border. 

### Exercise 6
> What happens if you map an aesthetic to something other than a variable name, like `aes(colour = displ < 5)`?

**(Answer)** The colour indicates if each `displ` value is less than 4 or not. The ggpplot function will assign the result of this expression (displ < 5, which is going to be true or false) to a temporary variable and then will assign a colour for values > 5 and a different colour for values < 5). This is easy visualize by checking the results of this code:

```{r eval = TRUE}
ggplot(data = mpg) + geom_point(mapping = aes(x = hwy, y = cyl, colour = displ < 4))
```

## 3.5.1 Exercises

### Exercise 1
> What happens if you facet on a continuous variable?

**(Answer)** To remember the variables classification:

Continuous  | Categorical
----------- | -----------
displ       | model
year        | trans
cyl         | drv
cty         | fl
hwy         | class

Let's plot and see what happens!

```{r eval = TRUE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ displ, nrow = 2)
```

As you can see, it converts the continuous variable to a factor and then creates facets for all unique values of it. Facets is particularly useful for **categorical** variables.

### Exercise 2
> What do the empty cells in plot with **facet_grid(drv ~ cyl)** mean? How do they relate to this plot?

```{r eval = TRUE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(drv ~ cyl)
```

**(Answer)** The empty cells means that there are no values for the combination of `drv` and `cyl`. In this case, there are no cars which the traction control system is 4wd and the number of cylinders is 5, for example (you can check the same for the two others empty cells).

### Exercise 3
> What plots does the following code make? What does `.` do?

Let's see!
```{r eval = TRUE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(drv ~ .)

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(. ~ cyl)
```

**(Answer)** As you can see in these two plots, `.` ignores a dimension for faceting (x or y axis).

### Exercise 4
> Take the first faceted plot in this section:

```{r eval = TRUE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2)
```

> What are the advantages to using faceting instead of the colour aesthetic? What are the disadvantages? How might the balance change if you had a larger dataset?

Let's run this code (again):

```{r eval = TRUE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2)
```

**(Answer)** Using faceting could be a great option to visualize you data if the number of classes (categorical variable) is not so large because faceting permits to visualize each category separated and maybe this can show the information about your dataset better than when using colour aesthetic (if you want to see the results for each category or a set of categories, for example). However, for larger datasets we might face with a categorical variable with many possible results and for this situation is better to visualize the data using colour aesthetic. The function you use depends on your dataset.

### Exercise 5
> Read `?facet_wrap`. What does `nrow` do? What does `ncol` do? What other options control the layout of the individual panels? Why doesnâ€™t `facet_grid()` have `nrow` and `ncol` argument?

**(Answer)** `nrow` and `ncol` define the number of rows and columns and this is necessary since facet_wrap only facets on one variable. You also can change the layout of the individual panels with `scales`, `switch`, `as.table` or `dir`, for example.

Let's see what happens when we set `ncol = 7`, which is the number of different car classes (`class`).

```{r eval = TRUE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, ncol = 7)
```

Really cool, right?

On the other hand, `nrow` and `ncol` are not necessary in `face_grid()` because the number of rows and columns are already determined depending only on the variables that were chosen (number of unique values of the variables used). 

### Exercise 6
> When using `facet_grid()` you should usually put the variable with more unique levels in the columns. Why?

**(Answer)** This is usually used in this way just to be easier to visualize. Is better to see the plot larger horizontally than vertically. So, using the variable with more unique levels in the columns the plot will grow horizontally. On the other hand, if this variable is used in the rows, the plot will grow vertically and for humans, usually this is worse to visualize.

## 3.6.1 Exercises

### Exercise 1
> What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?

**(Answer)** Plot type - Geom you should use: 

Plot type  | Geom
---------- | -----------
Line chart | `geom_line()`
Boxplot    | `geom_boxplot()`
Histogram  | `geom_hist()`
Area chart | `geom_area()`

### Exercise 2
> Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.

```{r eval = TRUE}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) + 
  geom_point() + 
  geom_smooth(se = FALSE)
```

**(Answer)** As you can see in the previous plot, this code produces a scatter plot with `displ` on the x axis and `hwy` on the y axis and the points are coloured according to the `drv` variable. Also, there is a smooth line created with `geom_smooth` with the standard errors setted to false (`se = FALSE`) and fitted according to `drv`. 

### Exercise 3
> What does show.legend = FALSE do? What happens if you remove it? Why do you think I used it earlier in the chapter?

_I am no sure if my answer is one hundred percent correct for the last question of this exercise._

**(Answer)** `show.legend = FALSE` hides the legend for the plot. If you do not specify this, the default value is going to be true (plot will show the legend box, if there is more than one category). The book used it earlier in this chapter to create these 3 plots:

```{r eval = TRUE}
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy))

ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, group = drv))

ggplot(data = mpg) +
  geom_smooth(
    mapping = aes(x = displ, y = hwy, color = drv),
    show.legend = FALSE
  )
```

In this case, a legend just in the last plot is not a good idea because in the two first plots there is no legend for the plot. The legend would make a irregular presentation and would show a irrelevant information (out of the scope of the goal that these 3 plots have).

### Exercise 4
> What does the `se` argument to `geom_smooth()` do?

The answer for this question is inside the exercise 2 answer. The `se` argument used in `geom_smooth()` is used to specify if you want to plot with the standard errors (default or set `se = TRUE`) or not (`se = FALSE`). In the plot, the standard error is the 'grey shadow'.

### Exercise 5
> Will these two graphs look different? Why/why not?

```{r eval = TRUE}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()

ggplot() + 
  geom_point(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_smooth(data = mpg, mapping = aes(x = displ, y = hwy))
```

**(Answer)** As you can see, these two codes produce idendical plots. The first code specifies the data and mapping inside `ggplot()` function, which will automatically be used by geoms functions (in this case, `geom_point()` and `geom_smooth()`). In the second code, the data and mapping definition are specified in both geoms (duplicated code, which is bad even if works). 

### Exercise 6
> Recreate the R code necessary to generate the following (6) graphs.

**(Answer)** 

```{r eval = TRUE}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth(se = FALSE)

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth(mapping = aes(group = drv), color = 'blue', se = FALSE)

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(colour = drv)) + 
  geom_smooth(mapping = aes(group = drv, colour = drv), se = FALSE)

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(colour = drv)) + 
  geom_smooth(colour = 'blue', se = FALSE)

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(colour = drv)) + 
  geom_smooth(colour = 'blue', se = FALSE)

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(colour = drv)) + 
  geom_smooth(colour = 'blue', se = FALSE)

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(colour = drv)) + 
  geom_smooth(mapping = aes(linetype = drv), colour = 'blue', se = FALSE)

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(colour = drv))
```

_Easy peasy lemon squeezy_.









